

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />

    <link href="~/Content/bootstrap.min.css" rel="stylesheet">
    <script src="~/Scripts/jquery-1.11.3.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/layer-v2.4/layer/layer.js"></script>

    <!--<link href="css/bootstrap.min.css" rel="stylesheet">-->
    <!--<script src="js/jquery-1.7.1.min.js"></script>-->
    <!--<script src="js/bootstrap.min.js"></script>-->
    <!--<script src="layer-v2.4/layer/layer.js"></script>-->


    <title>Index</title>
</head>
<body>
    <h1 id="today" align="center">
        今天是
    </h1>
    <h2>今天上映的电影有：</h2><br />
    <div id="movies">

    </div>

    <script>
    var selected_display_id = -1;
    var selected_schedule_id = -1;
    var seats = [];
    var snacks = [];
    var operator_id;
    var movies = {};
    //异步获取当天有排片的电影
    var today = new Date();
    var year = today.getFullYear();
    var month = today.getMonth()+1;
    var day = today.getDate()+1;
    var load_layer;
    today = year + "-" + month + "-" + day;

    document.getElementById("today").innerHTML += month + "月" + day + "号";


    $.ajax({
        type: "GET",
        url: "/sale/getmovies/" + today,
        beforeSend: function () {
            load_layer = layer.load(1, {
                shade: [0.1,'#fff'] //0.1透明度的白色背景
            });
        },
        success: function (res) {
            console.log(res);
            movies = eval("(" + res + ")");
            for (var i in movies){
                var toappend = document.createElement("button");
                toappend.id = movies[i].MOVIE_ID;
                toappend.className = "btn btn-info btn-lg";
                toappend.innerHTML = movies[i].NAME;
                toappend.onclick = function () {
                    var url = "/sale/getschedules/" + today + "/" + movies[i].MOVIE_ID;
                    window.location.href = url;
                };
                document.getElementById("movies").appendChild(toappend);
            }
            layer.close(load_layer);
        }
    });


    function getDay(time) {
        var today = new Date(time);
        var month = today.getMonth()+1;
        var day = today.getDate();
        var weekday = today.getDay()+1;
        var chinese;
        switch (weekday)
        {
            case 1: chinese = "一"; break;
            case 2: chinese = "二"; break;
            case 3: chinese = "三"; break;
            case 4: chinese = "四"; break;
            case 5: chinese = "五"; break;
            case 6: chinese = "六"; break;
            case 7: chinese = "七"; break;
        }
        var result = month + '.' +day + '(周' + chinese + ')';
        return result;
    }

    </script>
</body>
</html>

